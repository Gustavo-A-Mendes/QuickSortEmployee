import{Funcionario}from"./funcionario.js";document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("aquivoEnviado");const c=document.getElementById("dadosDaTabela"),r=c.querySelector("tbody"),a=document.getElementById("formTabela"),l=document.getElementById("folhaSalarial");var t=document.getElementById("downloadButton"),n=document.getElementById("criarPlanilha");const d=document.getElementById("bemVindo"),i=document.getElementById("tabela");function ಠ_ಠ163(e){const a=document.createElement("tr");for(const o of[e.nome,e.cargo,e.salario]){var t=document.createElement("td");t.ಠ_ಠ152=o,a.appendChild(t)}var e=document.createElement("td"),n=(e.classList.add("tamanho"),document.createElement("button")),n=(n.ಠ_ಠ153='<i class="bi bi-pencil-square ಠ_ಠ149-0"></i>',n.addEventListener("click",function(){var e,t,n;e=a,t=e.querySelectorAll("td"),(n=document.getElementById("formTabela")).elements.name.ಠ_ಠ154=t[0].ಠ_ಠ152,n.elements.cargo.ಠ_ಠ154=t[1].ಠ_ಠ152,n.elements.salario.ಠ_ಠ154=t[2].ಠ_ಠ152,e.remove(),ಠ_ಠ148()}),e.appendChild(n),a.appendChild(e),document.createElement("td")),e=(n.classList.add("tamanho"),document.createElement("button")),e=(e.ಠ_ಠ153='<i class="bi bi-trash btn ಠ_ಠ149-0"></i>',e.addEventListener("click",function(){{var e=a;e.remove(),e=r.querySelectorAll("tr td:nth-child(3)");let t=0;e.forEach(e=>{e=parseFloat(e.ಠ_ಠ152.replace("R$","").replace(/\./g,"").replace(",",".").trim());t+=e}),l.querySelector("h2").ಠ_ಠ152=ಠ_ಠ149(t),ಠ_ಠ148()}}),n.appendChild(e),a.appendChild(n),r.appendChild(a),ಠ_ಠ148(),function(){let t=0;var e=r.querySelectorAll("tr td:nth-child(3)");return e.forEach(e=>{e=parseFloat(e.ಠ_ಠ152.replace("R$","").replace(".","").replace(",",".").trim());t+=e}),ಠ_ಠ149(t)}());l.querySelector("h2").ಠ_ಠ152=""+e}function ಠ_ಠ147(){var e,t,n=Array.from(r.querySelectorAll("tr"));n.sort((e,t)=>e.cells[0].ಠ_ಠ152.localeCompare(t.cells[0].ಠ_ಠ152));for(e of n)r.appendChild(e);r.querySelectorAll("tr td:nth-child(3)").forEach(e=>{var t=parseFloat(e.ಠ_ಠ152.replace("R$","").replace(".","").replace(",",".").trim());e.ಠ_ಠ152=ಠ_ಠ149(t)});for(t of n){var a,o=t.cells[2];o.ಠ_ಠ152.startsWith("R$")||(a=o.ಠ_ಠ152,o.ಠ_ಠ152="R$ "+a)}}function ಠ_ಠ148(){var e=r.querySelectorAll("tr").length;document.getElementById("totalFuncionarios").ಠ_ಠ152=e}function ಠ_ಠ149(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}n.addEventListener("click",function(){var e=document.createElement("thead"),t=document.createElement("tr"),n=["Nome","Cargo","Salário"];for(const o of n){var a=document.createElement("th");a.ಠ_ಠ152=o,t.appendChild(a)}e.appendChild(t),c.appendChild(e);e=XLSX.utils.aoa_to_sheet([n]),n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,e,"Planilha Vazia"),new Blob([function(t){var e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e<t.length;++e)n[e]=255&t.charCodeAt(e);return e}(XLSX.write(n,{bookType:"xlsx",type:"binary"}))],{type:"application/octet-stream"});d.style.ಠ_ಠ158="none",i.style.ಠ_ಠ158="block",c.style.ಠ_ಠ158="table"}),e.addEventListener("change",function(e){var t,e=e.target.files[0];e&&((t=new FileReader).ಠ_ಠ160=function(e){var e=new Uint8Array(e.target.result),e=XLSX.read(e,{type:"array"}),t=e.SheetNames[0],e=e.Sheets[t],n=XLSX.utils.sheet_to_json(e,{header:1}),t=document.createElement("thead"),a=document.createElement("tr");for(const r of["Nome","Cargo","Salário"]){var o=document.createElement("th");o.ಠ_ಠ152=r,a.appendChild(o)}t.appendChild(a),c.appendChild(t);for(let e=0;e<n.length;e++)0!==e&&ಠ_ಠ163(new Funcionario(n[e][0],n[e][1],n[e][2]));c.style.ಠ_ಠ158="table",ಠ_ಠ147(),d.style.ಠ_ಠ158="none",i.style.ಠ_ಠ158="block"},t.readAsArrayBuffer(e))}),a.addEventListener("submit",function(e){e.preventDefault();var e=document.getElementById("name").ಠ_ಠ154,t=document.getElementById("cargo").ಠ_ಠ154,n=document.getElementById("salario").ಠ_ಠ154;e&&t&&n?(ಠ_ಠ163(new Funcionario(e,t,n)),ಠ_ಠ147(),a.reset()):alert("Preencha todos os campos do formulário.")}),t.addEventListener("click",function(){var e=[];for(const r of c.querySelector("thead tr").cells)e.push(r.ಠ_ಠ152);var t=[];for(const l of c.querySelectorAll("tbody tr")){var n=[];for(let e=0;e<l.cells.length-2;e++)n.push(l.cells[e].ಠ_ಠ152);t.push(n)}var a=[e,...t],a=XLSX.utils.aoa_to_sheet(a),o=XLSX.utils.book_new(),a=(XLSX.utils.book_append_sheet(o,a,"Tabela"),XLSX.write(o,{bookType:"xlsx",type:"binary"}));o=new Blob([function(t){var e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e!==t.length;++e)n[e]=255&t.charCodeAt(e);return e}(a)],{type:"application/octet-stream"}),a=document.createElement("a");a.ಠ_ಠ161=URL.createObjectURL(o),a.ಠ_ಠ162="Funcionarios.xlsx",a.click()}),$(document).ready(function(){$("#salario").maskMoney({thousands:".",decimal:",",affixesStay:!1})})});